# 허브와 라우터

#### 허브

LAN 어댑터를 거쳐 디지털데이터 -> 전기신호가 된 신호는 이제 리피터 허브 -> 스위칭 허브 -> 라우터를 거쳐서 인터넷 접속용 라우터 -> 인터넷으로 나가게 됩니다.

###To 리피터허브

우선 패킷이 LAN어댑터에서 케이블로 나가게 됩니다. 여기서 케이블은 RJ-45커넥터를 통해 Twist Pair Cable입니다.  좀더 확대해보면

LAN어댑터의 PHY(physical layer device)(신호 송수신 회로) 회로 -> RJ-45커넥터 -> Twist Pair Cable의 구성입니다.

여기서 Twist Pair Cable은 흔히 말하는 여러 색의 8줄로 이루어진 랜선입니다.  그런데 이 케이블로 넘어간 신호는 허브를 향해 가는데 허브에 도착하면 신호가 약해져 있습니다. 각이 뭉개진다거나, 파형이 왜곡된다거나, 신호의 높이가 낮아지게 됩니다. 이러한 이유는 주파수가 높을수록 에너지가 떨어지는 비율이 높아지기 때문이니다.  즉 에너지에 손실이 발생하는 것입니다. 이럴경우 0과 1을 잘못판단할 수 있는데 이 경우 통신 오류가 됩니다. 

### 에너지 손실

에너지의 손실이 발생하는 이유는 전자파입니다. 전자파가 도전체(금속과 같은)에 닿으면 그 안에 전류가 발생하여 기존의 다른 전류에 뒤섞여 파형이 변동되는 것입니다. 케이블이 영향을 받는 전자파는 두 종류입니다.

첫째는 모니터, 형광등, CRT 모니터와 같은 기기에서 누설되는 전자파입니다. 두번째는 같은 케이블 안의 인접한 신호선에서 누설되는 전자파입니다. 이는 신호라는 전류에 의해 전자파가 생기고 다른 신호선에 대한 잡음이 되는데 이를 크로스토크라고 합니다.

두가지 경우 모두 선을 꼬아서 해결할 수 있습니다. 전자는 신호선에 전자파가 닿으면 전자파의 진행방향의 오른쪽으로 전류가 생겨납니다. 그런데 신호선을 꼬아주면 나선형이되어 전류가 흐르는 반대 방향이 되게 됩니다. 그래서 잡음의 전류가 약해지게 됩니다. 후자의 경우 거리가 너무 가깝기 때문에 문제인데 신호선을 꼬는 간격을 미묘하게 모두 다르게 만들어 플러스와 마이너스를 바꿔서 잡음의 영향이 반대가 되게 만들어줍니다. 이러면 균형이 잡히면서 잡음의 영향이 줄어들게 됩니다.

또한 실드(피복)을 감싸거나 신호선 사이에 구분판을 넣어 잡음을 줄이는것도 방법입니다. 그걸 카테고리라는 척도로 성능을 나타냅니다.

### 전체에 송신

리피터 허브에 도착하게 되면 이더넷의 원리에 따라 접속해있는 모든 LAN전체에 신호가 흩어집니다. 거기서 MAC주소에 해당하는 기기가 그 패킷을 낚아채게 됩니다. 이러한 이더넷의 원리를 그대로 실현한 것이 리피터 허브입니다. 

이 리피터 허브에 들어와 리피터 허브의 PHY회로의 수신부로 도달하면 여기서부터는 리피터 회로에 들어가게 됩니다. 리피터회로는 들어오는 신호를 리피터 허브의 커넥터 부분에 뿌리게 됩니다. 다시말해 커넥터에 송출하는 것입니다.이후 신호는 모든 커넥터를 걸치며 MAC주소가 일치하는 곳으로 가게 됩니다. 혹시 잡음의 영향으로 파형이 변화되었어도 여기에서는 검사하지 않으며 다음기기인 스위칭 허브, 라우터, 서버 등 까지는 도달하게 됩니다. 이 곳에서 FCS(Frame Check Sequence)를 검사하게 됩니다.

성공과 실패를 결정하는 1%의 네트워크원리, Tcutomu Tone, 이도희 옮김, 성안당