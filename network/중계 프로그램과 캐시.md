# 통신을 중계하는 프로그램과 캐시

프록시와 게이트웨이 터널과 캐시에 대해 알아보도록하자.

## 개요

웹은 기본적으로 클라이언트와 서버의 통신으로 이루어진다. 그런데 그 사이를 중계하는 프로그램이 있다. 프록시, 게이트웨이, 터널의 세가지가 있다.

### 프록시

흔히 알고있는 프록시다. 서버와 클라이언트 두가지 역할을 중계한다.  클라이언트의 요청을 받아 오리진 서버(리소스 본체를 가진 서버)에게 전달하고 오리진 서버의 응답을 클라이언트에게 전달한다. 프록시 서버는 여러대를 경유하는 것도 가능합니다. 체이닝을 생각하면 쉽습니다. 클라이언트 - 프록시 - 프록시 - 서버의 구조입니다.

프록시를 사용하는 이유는 크게 두가지가 있습니다.

1. 캐시사용
2. 특정 사이트에 대해 권한관리(보안)

캐시는 [아래](#캐시)에서 더 설명하도록 하겠습니다. 

권한관리의 경우 특정 사이트의 접근 제한이나, 로그를 획득하여 보안적인 측면에서 관리를 하려는 목적을 가집니다.

프록시를 사용하는 방법은 여러가지인데, 2개의 기준으로 분류합니다. 

1. 캐싱프록시
   [캐시](#캐시)에서 더 설명하도록 하겠습니다. 캐시를 사용하기 위한 프록시 서버를 캐싱프록시라고 합니다. 
2. Transparent(투명) 프록시
   중계시겡 메시지를 변경하지 않는 타입을 투명프록시라고 합니다. 반대의 경우 비투과 프록시라고 합니다.

### 게이트웨이

게이트웨이는 프록시와 역할은 거의 비슷합니다. 똑같이 중계를 해주는데 , 다른점은 서버가 HTTP서버 이외의 서비스를 제공하는 서버라는 점입니다. 예를들어 데이터베이스에 접속하여 SQL쿼리를 사용할 경우 데이터를 얻는 곳에 게이트웨이를 사용할 수 있습니다. 또 쇼핑이나, 신용카드, 결제 시스템과 같은 연계에도 게이트웨이도 사용합니다.

게이트웨이는 암호화와 같은 역할로 통신의 안전성을 높이는 역할을 합니다.

### 터널

터널은 SSL에서 배웠듯 중계라기 보다는 안전한 암호와 통신을 지원하는 것입니다.  해석하지 않고 단순히 정말 터널의 역할로 외부의 접근을 막는 역할을 합니다.

### 캐시

캐시는 프록시서버 혹은 클라이언트 로컬 디스크에 리소스의 사본을 만들어 저장한 것을 말합니다. 리소스를 자꾸 받아오면 데이터의 양이 클 경우 통신 시간이 너무 길어지기 때문에 사본을 만들어 저장하는 것입니다. redis이나 noSql를 사용하는 것도 비슷한 이유입니다. 

[get과post](./get과-post.md)에서 언급했듯이 get은 캐시를 이용하기 때문에 사본을 가져와 빠르지만 최신화되지 않은 데이터를 이용할 수 있고, post의 경우 캐시를 이용하지 않기 때문에 항상 최신의 데이터를 가져오지만 느리다는 단점이 있다.

캐시는 유효기간을 가지기 때문에 일정 시간이 지나면 최신의 데이터로 갱신하게 됩니다.



####참고자료

그림으로 배우는 Http Network Basic, 우에노 센, 이병억 옮김, 영진닷컴