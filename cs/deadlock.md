# Deadlock

교착상태(이하 deadlock)라고 합니다. 면접때 질문을 받았는데 대답을 못해서 정리해봅니다 ㅠㅠ(공부하면 되죠!)

교착상태라는 개념을 모르지는 않았는데 순간적으로 deadrock으로 들려서 대답을 못했다 ㅋㅋ

한 자원을 사용할 때는 lock이라는 것을 가진다. 이는 자바 쓰레드 환경에서도 역시 lock을 공부했었다. 

쉽게 생각하면 사다리를 이용할 때 나 올라가요! 하고 lock을 걸고 반납한다. 그 다음 다른 사람이 lock을 받아서 올라가거나 내려간다.

이 때 발생하는 문제가 deadlock이다. 만약에 내가 올라가고 있는데 누가 내려오려고 한다면 어떻게 될까? 둘다 아무것도 하지 못하고 가만히 있는 상태가 발생하는데 이를 deadlock이라고 한다.

이 deadlock이 발생하는 조건은 4가지 조건을 모두 만족해야만 한다고 1971년 코프만 교수가 밝혔다.

1. 상호배제(Mutual exclusion): 프로세스들이 필요로 하는 자원에 대해 배타적인 통제권을 요구한다.
2. 점유대기(Hold and wait) : 프로세스가 할당된 자원을 가진 상태에서 다른 자원을 기다린다.
3. 비선점(No preemption) : 프로세스가 어떤 자원의 사용을 끝낼 때까지 그 자원을 뺏을 수 없다.
4. 순환대기(Circular wait) : 각 프로세스는 순환적으로 다음 프로세스가 요구하는 자원을 가지고 있다.

이 4가지 조건을 만족한다면 교착 상태를 막을 방법은 없다.  따라서 이를 막기 위한 방법은 이 4가지 조건을 제거하는 것이다.

1. 한 자원을 공유하지 않게 한다.
2. 한 프로세스에만 모든 자원을 할당하고 그 뒤에 점유하지 않으면 다른 프로세스가 사용하게 한다.
3. 자원을 뺏지 못하게 한다.
4. 순서를 매겨 순환한다.

결국에 한 자원을 동시에 사용하지 말자는 얘기다. 근데 이러면 효율성이 떨어지고 비용이 발생하는 것은 당연한 얘기다.



참고 자료 : https://ko.wikipedia.org/wiki/%EA%B5%90%EC%B0%A9_%EC%83%81%ED%83%9C